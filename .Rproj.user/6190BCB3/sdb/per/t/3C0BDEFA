{
    "collab_server" : "",
    "contents" : "\n\nsetwd(\"C:/Users/weny/Documents/DHS/Angola/Standard DHS 2015-16\")\n\nlibrary(dplyr)\nlibrary(magrittr)\nlibrary(tidyverse)\nlibrary(survey)\nlibrary(foreign)\nlibrary(data.table)\nlibrary(ggplot2)\nlibrary(reshape2)\nlibrary(readr)\nlibrary(xlsx)\nlibrary(httr)\nlibrary(gridExtra)\nlibrary(devtools)\nlibrary(remotes)\nlibrary(DemoTools)\nlibrary(scales)\nlibrary(ipumsr)\nlibrary(stringr)\nlibrary(regex)\nlibrary(lodown)\noptions(scipen=999) # disable scientific notation\n\n# DHS ---------------------------------------------------------------------\n\nif(survey == \"dhs\"){\n  \n  # Read in survey data -----------------------------------------------------\n  \n  raw_data <- \n    readRDS( \n      file.path( \"AOBR71FL.rds\" )\n    )\n  \n  # convert the weight column to a numeric type\n  raw_data$weight <- as.numeric(raw_data$v005 )\n\n   raw_data <- raw_data %>%\n    select(c(\"weight\", \"v021\",\"v022\", \"v024\", \n             \"v312\", \"v313\")) %>%\n    mutate(id = 1)\n  \n  # Bring in complex survey format ------------------------------------------\n  \n  survey <- svydesign(id      = raw_data$v021,         # Primary sampling\n                      strata  = raw_data$v022,         # Strata used for standard errors\n                      weights = raw_data$weight/1000000, # HH sample weight\n                      data    = raw_data)               # Data\n  \n  \n  \n  # Method mix --------------------------------------------------------------\n  \n  a <-  as.data.frame(attr(raw_data, \"variable.labels\"))\n  # national level\n  svymean(~v312, survey)\n  \n  \n  # estimate share of sex/age groups by region\n  output <- as.data.frame(svyby(~v312, ~v024,  survey, svymean))\n  \n  output <- output[2:19]\n  \n  names(output) <- substring(names(output), 5)\n  \n  write.xlsx(WRA, \"./Results/method_mix.xlsx\")\n  \n  \n  \n  # Type of method ----------------------------------------------------------\n  \n  \n  # national level\n  svymean(~v313, survey)\n  \n  \n  # estimate share of sex/age groups by region\n  output <- as.data.frame(svyby(~V313, ~V024,  survey, svymean))\n  \n  output <- output[2:5]\n  \n  names(output) <- substring(names(output), 5)\n  \n  write.xlsx(WRA, \"./Results/type_of_FP_method.xlsx\")\n  \n  \n  # Sex and age structure at Admin1 -----------------------------------------\n  \n  \n}\n\n\n\n# MICS --------------------------------------------------------------------\n\n\nif(survey == \"mics\"){\n  \n  \n  \n}\n}\n\n",
    "created" : 1534405962138.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "268960930",
    "id" : "3C0BDEFA",
    "lastKnownWriteTime" : 1534407462,
    "last_content_update" : 1534407462607,
    "path" : "C:/Users/weny/Google Drive/2018/Humanitarian/MISP/MISP-Rproject/Survey extract.R",
    "project_path" : "Survey extract.R",
    "properties" : {
        "tempName" : "Untitled1"
    },
    "relative_order" : 3,
    "source_on_save" : false,
    "source_window" : "",
    "type" : "r_source"
}